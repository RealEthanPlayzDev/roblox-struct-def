--[[
   Roblox StructDef v1.0.0 [2021-02-28 22:10]

   The Structure Definition, or simply StructDef, is a library that allows the 
   serialization and deserialization of structured data. You define how you want 
   your data to be structured once and then you can use the generated instance 
   to easily write and read your structured data to and from a UTF-8 string.
   
   This is a minified version of Roblox StructDef, to see the full source 
   code visit https://github.com/nidorx/roblox-struct-def

   Discussions about this script are at https://devforum.roblox.com/t/ID_FORUM

   ------------------------------------------------------------------------------

   MIT License

   Copyright (c) 2021 Alex Rodin

   Permission is hereby granted, free of charge, to any person obtaining a copy
   of this software and associated documentation files (the "Software"), to deal
   in the Software without restriction, including without limitation the rights
   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   copies of the Software, and to permit persons to whom the Software is
   furnished to do so, subject to the following conditions:

   The above copyright notice and this permission notice shall be included in all
   copies or substantial portions of the Software.

   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   SOFTWARE.
]]
do local a={aQ='bool',aR='bool[]',aS='int32[]',aT='int32',aU='int53[]',aV='int53',aW='double[]',aX='double',aY='string[]',aZ='string',ba='ref[]',bc='unknown',bf='Unexpected field id ',bi='number',bD='Vector3',bI='WARNING: Deserialize - O tipo do campo é diferente do valor serializado (',bJ='SCHEMA_ID=',bL='FIELD_ID=',bN='FIELD_NAME=',bP='FIELD_TYPE=',bR='CONTENT_FIELD_TYPE=',bU='[WARNING] Schema:Serialize - Recebeu nil como entrada, ignorando serialização (Name=',cb='Unexpected value (',cc=') in the header at position ',cd='[WARNING] Deserialize - O conteúdo faz referência para um schema não cadastrado (SCHEMA_ID=',ci='O Id do campo deve ser um número inteiro entre 0 e 16',ck='O Nome do campo deve ser uma string válida',cl='O Tipoo de dado do campo é requerido',cm='Já existe um campo registrado com o mesmo nome ',cn='Já existe um campo registrado com o mesmo id ',co='O Tipoo de dado do campo é inválido',cp='function',cq='O método Encoder uma função como parametro de entrada',cr='O método Decoder uma função como parametro de entrada',cs='O id do eschema deve ser >= 0 e <= 254',ct='Já existe um schema registrado com o Id informado',cx='rshift',cy='lshift',cA='index',cC='content',cE='concat',cF='shift',cG='get_field_type_name',cH='header_increment',cI='header_flush',cJ='encode_byte',cK='decode_char',cL='encode_field',cM='decode_field_byte',cN='FIELD_TYPE_BITMASK_BOOL',cO='FIELD_TYPE_BITMASK_BOOL_ARRAY',cP='FIELD_TYPE_BITMASK_INT32',cQ='FIELD_TYPE_BITMASK_INT53',cR='FIELD_TYPE_BITMASK_DOUBLE',cS='FIELD_TYPE_BITMASK_STRING',cT='FIELD_TYPE_BITMASK_SCHEMA',cU='FIELD_TYPE_BITMASK_SCHEMA_END',cV='HEADER_EMPTY_BYTE',cW='HEADER_BITMASK_INDEX',cX='HEADER_END_MARK',cZ='insert',da='encode_field_bool',db='encode_field_bool_array',dc='decode_bool_array_byte',dd='round',dh='ValueFits',di='Value',dj='Bytes',dk='IsNegative',dl='HasMore',dm='Items',dn='encode_int32',_do='decode_int32_extra_byte',dp='decode_int32_bytes',dq='encode_int32_array',dr='decode_int32_array_extra_byte',ds='INT6_MAX',dt='INT8_MAX',du='INT16_MAX',dv='INT24_MAX',dw='INT32_MAX',dx='INT_EXTRA_BITMASK_NEGATIVE',dy='INT_EXTRA_BITMASK_IT_FITS',dz='INT_EXTRA_BITMASK_VALUE',dA='INT_EXTRA_BITMASK_BYTE_COUNT',dB='INT_EXTRA_BITMASK_NUM_BYTES',dC='floor',dD='IsBig',dE='BytesTimes',dF='BytesRest',dG='encode_int53_out',dH='encode_int53',dI='decode_int53_extra_byte',dJ='decode_int53_bytes',dK='encode_int53_array',dL='INT53_MAX',dM='HasDec',dN='BytesDec',dO='encode_double',dP='decode_double_extra_byte',dQ='decode_double_bytes',dR='encode_double_array',dT='MaxLength',dV='SizeFits',dY='encode_string',dZ='decode_string_extra_byte_first',ea='decode_string_extra_byte_second',eb='encode_string_array',ec='STRING_MAX_SIZE',ed='Schema',ee='FieldsById',eg='IsArray',eh='ConvertToInstance',ej='Fields',ek='ConvertToSerialize',el='EncodeFn',em='charpattern',en='Index',eo='Count',ep='header',eq='fieldDecoded',er='inHeader',es='inHeaderBit2',et='schemaId',eu='schema',ev='inExtraByte',ew='extraByteDecoded',ex='isCaptureBytes',ey='captureCount',ez='capturedBytes',eA='stringCount',eB='stringValue',eC='value',eD='object',eE='isCaptureChars',eF='capturedChars',eG='Default',eH='remove',eI='__index',eJ='isSchema',eK='ToSerialize',eL='ToInstance',eM='EncoderFn',eN='DecoderFn',eO='Deserialize'}local b=game:GetService('ReplicatedStorage')local c={}local d={}local e=function(f)if not c[f]then c[f]={r=d[f]()}end;return c[f].r end;d[1]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local k={"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"}k[0]='!'local l={}for m=0,table.getn(k)do l[k[m]]=m end;local n='<'local o=0;local p=32;local q=64;local r=96;local s=128;local t=160;local u=192;local v=224;local w=15;local x=16;local y=224;local z=64;local A={32,16,8,4,2,1}local function B(C,D)if C==o then return a.aQ elseif C==p then return a.aR elseif C==q then if D then return a.aS else return a.aT end elseif C==r then if D then return a.aU else return a.aV end elseif C==s then if D then return a.aW else return a.aX end elseif C==t then if D then return a.aY else return a.aZ end elseif C==u then if D then return a.ba else return'ref'end else return a.bc end end;local function E(F)if F[a.cA]>6 then if F.byte==92 then F.byte=62 end;if F.byte==127 then F.byte=63 end;F[a.cC][#F[a.cC]+1]=string.char(F.byte)F.byte=z;F[a.cA]=1 end end;local n='='local function G(F)if F[a.cA]>1 then F[a.cA]=7;E(F)end;F[a.cC][#F[a.cC]+1]=n;F[a.cC]=table[a.cE](F[a.cC],'')end;local function H(F,I)local J;if I<92 then J=k[I]F[a.cA]=F[a.cA]+1 elseif I<184 then J=k[I-92]F.byte=g(F.byte,A[F[a.cA]])F[a.cA]=F[a.cA]+1;E(F)F[a.cA]=F[a.cA]+1 else J=k[I-184]F.byte=g(F.byte,A[F[a.cA]])F[a.cA]=F[a.cA]+1;E(F)F.byte=g(F.byte,A[F[a.cA]])F[a.cA]=F[a.cA]+1 end;E(F)return J end;local function K(F,L)local I=l[L]local M=F[a.cF][F[a.cA]]F[a.cA]=F[a.cA]+1;if M==0 then return I elseif M==1 then return I+92 else return I+184 end end;local function N(F,O,C,D)if O>16 or O<0 then error(a.bf..O)end;local I=g(O,C)if D then I=g(I,x)end;return H(F,I)end;local function P(I)return{Id=h(I,w),Type=h(I,y),IsArray=h(I,x)~=0}end;local Q={}Q[a.cG]=B;Q[a.cH]=E;Q[a.cI]=G;Q[a.cJ]=H;Q[a.cK]=K;Q[a.cL]=N;Q[a.cM]=P;Q[a.cN]=o;Q[a.cO]=p;Q[a.cP]=q;Q[a.cQ]=r;Q[a.cR]=s;Q[a.cS]=t;Q[a.cT]=u;Q[a.cU]=v;Q[a.cV]=z;Q[a.cW]=A;Q[a.cX]=n;return Q end;d[2]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local H=R[a.cJ]local N=R[a.cL]local o=R[a.cN]local p=R[a.cO]local S=192;local T=16;local U=1;local V={0,64,128,192}local W={32,16,8,4}local function X(F,Y,Z)return N(F,Y.Id,o,Z==true)end;local function _(F,Y,Z)local a0=table.getn(Z)if Z==nil or a0==0 then return''end;local J={}local a1=0;local I=0;for m,a2 in ipairs(Z)do a1=a1+1;if a1>4 then I=g(I,V[4])if m<a0 then I=g(I,1)end;if#J==0 then J[#J+1]=N(F,Y.Id,p,true)end;J[#J+1]=H(F,I)I=0;a1=1 end;if a2 then I=g(I,W[a1])end end;if a1>0 then I=g(I,V[a1])if#J==0 then J[#J+1]=N(F,Y.Id,p,true)end;J[#J+1]=H(F,I)end;return table[a.cE](J,'')end;local function a3(I,a4)local a5=i(h(I,S),6)+1;for a1=1,a5 do table[a.cZ](a4,h(I,W[a1])>0)end;return h(I,U)>0 end;local Q={}Q[a.da]=X;Q[a.db]=_;Q[a.dc]=a3;return Q end;d[3]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local H=R[a.cJ]local N=R[a.cL]local q=R[a.cP]local a6=128;local a7=64;local a8=63;local a9=12;local aa={0,4,8,12}local ab=63;local ac=255;local ad=65535;local ae=16777215;local af=4294967295;local function ag(F,Y,Z)if Z==nil or type(Z)~=a.bi then return''end;Z=math[a.dd](Z)if Z==0 then return''end;local J={N(F,Y.Id,q,false)}local ah=0;if Z<0 then ah=g(ah,a6)end;Z=math.min(af,math.max(0,math.abs(Z)))if Z<=ab then ah=g(ah,Z)ah=g(ah,a7)J[#J+1]=H(F,ah)elseif Z<=ac then ah=g(ah,aa[1])J[#J+1]=H(F,ah)J[#J+1]=H(F,Z)elseif Z<=ad then ah=g(ah,aa[2])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))elseif Z<=ae then ah=g(ah,aa[3])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,16),0xFF))J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))else ah=g(ah,aa[4])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,24),0xFF))J[#J+1]=H(F,h(i(Z,16),0xFF))J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))end;return table[a.cE](J,'')end;local function ai(ah)local J={}local aj=h(ah,a6)~=0;if h(ah,a7)~=0 then local Z=h(ah,a8)if aj then Z=-1*Z end;J[a.dh]=true;J[a.di]=Z else J[a.dj]=i(h(ah,a9),2)+1;J[a.dh]=false;J[a.dk]=aj end;return J end;local function ak(al,aj)local a0=#al;local Z;if a0==1 then Z=al[1]elseif a0==2 then Z=g(j(al[1],8),al[2])elseif a0==3 then Z=g(j(al[1],16),g(j(al[2],8),al[3]))else Z=g(j(al[1],24),g(j(al[2],16),g(j(al[3],8),al[4])))end;if aj then Z=-1*Z end;return Z end;local am={32,2}local an={16,1}local ao={{192,6},{12,2}}local ap={{0,64,128,192},{0,4,8,12}}local function aq(F,Y,ar)if ar==nil or#ar==0 then return''end;local J={N(F,Y.Id,q,true)}local ah=0;local al={}local a0=#ar;local a1=1;for m,Z in ipairs(ar)do if Z==nil or type(Z)~=a.bi then Z=0 end;Z=math[a.dd](Z)if Z<0 then ah=g(ah,am[a1])end;if m<a0 then ah=g(ah,an[a1])end;Z=math.min(af,math.max(0,math.abs(Z)))if Z<=ac then al[#al+1]=Z elseif Z<=ad then ah=g(ah,ap[a1][2])al[#al+1]=h(i(Z,8),0xFF)al[#al+1]=h(Z,0xFF)elseif Z<=ae then ah=g(ah,ap[a1][3])al[#al+1]=h(i(Z,16),0xFF)al[#al+1]=h(i(Z,8),0xFF)al[#al+1]=h(Z,0xFF)else ah=g(ah,ap[a1][4])al[#al+1]=h(i(Z,24),0xFF)al[#al+1]=h(i(Z,16),0xFF)al[#al+1]=h(i(Z,8),0xFF)al[#al+1]=h(Z,0xFF)end;a1=a1+1;if a1>2 then J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end;a1=1;ah=0;al={}end end;if a1>1 then J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end;return table[a.cE](J,'')end;local function at(ah)local J={}local au={}au[a.dj]=i(h(ah,ao[1][1]),ao[1][2])+1;au[a.dk]=h(ah,am[1])~=0;au[a.dl]=h(ah,an[1])~=0;J[a.dm]={au}if J[a.dm][1][a.dl]then local au={}au[a.dj]=i(h(ah,ao[2][1]),ao[2][2])+1;au[a.dk]=h(ah,am[2])~=0;au[a.dl]=h(ah,an[2])~=0;table[a.cZ](J[a.dm],au)end;return J end;local Q={}Q[a.dn]=ag;Q[a._do]=ai;Q[a.dp]=ak;Q[a.dq]=aq;Q[a.dr]=at;Q[a.ds]=ab;Q[a.dt]=ac;Q[a.du]=ad;Q[a.dv]=ae;Q[a.dw]=af;Q[a.dx]=a6;Q[a.dy]=a7;Q[a.dz]=a8;Q[a.dA]=a9;Q[a.dB]=aa;return Q end;d[4]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local H=R[a.cJ]local N=R[a.cL]local r=R[a.cQ]local av=e(3)local ab=av[a.ds]local ac=av[a.dt]local ad=av[a.du]local ae=av[a.dv]local af=av[a.dw]local a6=av[a.dx]local a9=av[a.dA]local aa=av[a.dB]local aw=9007199254740991;local ax=32;local ay=16;local az=3;local aA={0,1,2,3}local function aB(F,J,Z,aC)local ah=0;if Z<0 then ah=g(ah,a6)end;if aC then ah=g(ah,ay)end;Z=math.min(aw,math.max(0,math.abs(Z)))if Z<=ac then ah=g(ah,aa[1])J[#J+1]=H(F,ah)J[#J+1]=H(F,Z)elseif Z<=ad then ah=g(ah,aa[2])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))elseif Z<=ae then ah=g(ah,aa[3])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,16),0xFF))J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))elseif Z<=af then ah=g(ah,aa[4])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Z,24),0xFF))J[#J+1]=H(F,h(i(Z,16),0xFF))J[#J+1]=H(F,h(i(Z,8),0xFF))J[#J+1]=H(F,h(Z,0xFF))else ah=g(ah,ax)local aD=math[a.dC](Z/af)-1;local aE=Z-(aD+1)*af;local al={}if aD<=ac then al[#al+1]=aD elseif aD<=ad then ah=g(ah,aa[2])al[#al+1]=h(i(aD,8),0xFF)al[#al+1]=h(aD,0xFF)else ah=g(ah,aa[3])al[#al+1]=h(i(aD,16),0xFF)al[#al+1]=h(i(aD,8),0xFF)al[#al+1]=h(aD,0xFF)end;if aE<=ac then al[#al+1]=aE elseif aE<=ad then ah=g(ah,aA[2])al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)elseif aE<=ae then ah=g(ah,aA[3])al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)else ah=g(ah,aA[4])al[#al+1]=h(i(aE,24),0xFF)al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)end;J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end end;local function aF(F,Y,Z)if Z==nil or type(Z)~=a.bi then return''end;Z=math[a.dd](Z)if Z==0 then return''end;local J={N(F,Y.Id,r,false)}aB(F,J,Z,false)return table[a.cE](J,'')end;local function aG(ah)local J={}J[a.dk]=h(ah,a6)~=0;J[a.dD]=h(ah,ax)~=0;J[a.dl]=h(ah,ay)~=0;J[a.dE]=i(h(ah,a9),2)+1;J[a.dF]=h(ah,az)+1;return J end;local function aH(al,aj,aI,aJ)local aD,aE,Z;if aI==1 then aD=al[1]elseif aI==2 then aD=g(j(al[1],8),al[2])else aD=g(j(al[1],16),g(j(al[2],8),al[3]))end;if aJ==1 then aE=al[aI+1]elseif aJ==2 then aE=g(j(al[aI+1],8),al[aI+2])elseif aJ==3 then aE=g(j(al[aI+1],16),g(j(al[aI+2],8),al[aI+3]))else aE=g(j(al[aI+1],24),g(j(al[aI+2],16),g(j(al[aI+3],8),al[aI+4])))end;Z=(aD+1)*af+aE;if aj then Z=-1*Z end;return Z end;local function aK(F,Y,ar)if ar==nil or#ar==0 then return''end;local J={N(F,Y.Id,r,true)}local ah=0;local a0=#ar;for m,Z in ipairs(ar)do if Z==nil or type(Z)~=a.bi then Z=0 end;Z=math[a.dd](Z)aB(F,J,Z,m~=a0)end;return table[a.cE](J,'')end;local Q={}Q[a.dG]=aB;Q[a.dH]=aF;Q[a.dI]=aG;Q[a.dJ]=aH;Q[a.dK]=aK;Q[a.dL]=aw;return Q end;d[5]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local H=R[a.cJ]local N=R[a.cL]local s=R[a.cR]local av=e(3)local ab=av[a.ds]local ac=av[a.dt]local ad=av[a.du]local ae=av[a.dv]local af=av[a.dw]local a6=av[a.dx]local a9=av[a.dA]local aa=av[a.dB]local aL=e(4)local aw=aL[a.dL]local aM=96;local aN=24;local aO=4;local aP=2;local aQ=1;local aR={0,8,16,24}local aS={0,32,64,96}local function aT(F,J,Z,aC)local ah=0;if Z<0 then ah=g(ah,a6)end;if aC then ah=g(ah,aQ)end;local aU=false;Z=math.abs(Z)local aV=math[a.dC](Z)local aW=math[a.dC]((Z-aV)*10000)if aV~=Z then aU=true end;aV=math.min(aw,math.max(0,aV))local al={}if aV<=ac then al[#al+1]=aV elseif aV<=ad then ah=g(ah,aR[2])al[#al+1]=h(i(aV,8),0xFF)al[#al+1]=h(aV,0xFF)elseif aV<=ae then ah=g(ah,aR[3])al[#al+1]=h(i(aV,16),0xFF)al[#al+1]=h(i(aV,8),0xFF)al[#al+1]=h(aV,0xFF)elseif aV<=af then ah=g(ah,aR[4])al[#al+1]=h(i(aV,24),0xFF)al[#al+1]=h(i(aV,16),0xFF)al[#al+1]=h(i(aV,8),0xFF)al[#al+1]=h(aV,0xFF)else local aD=math[a.dC](aV/af)-1;local aE=aV-(aD+1)*af;if aD<=ac then ah=g(ah,aS[2])al[#al+1]=aD elseif aD<=ad then ah=g(ah,aS[3])al[#al+1]=h(i(aD,8),0xFF)al[#al+1]=h(aD,0xFF)else ah=g(ah,aS[4])al[#al+1]=h(i(aD,16),0xFF)al[#al+1]=h(i(aD,8),0xFF)al[#al+1]=h(aD,0xFF)end;if aE<=ac then al[#al+1]=aE elseif aE<=ad then ah=g(ah,aR[2])al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)elseif aE<=ae then ah=g(ah,aR[3])al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)else ah=g(ah,aR[4])al[#al+1]=h(i(aE,24),0xFF)al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)end end;if aU then ah=g(ah,aO)if aW<=ac then al[#al+1]=aW else ah=g(ah,aP)al[#al+1]=h(i(aW,8),0xFF)al[#al+1]=h(aW,0xFF)end end;J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end;local function aX(F,Y,Z)if Z==nil or type(Z)~=a.bi or Z==0 then return''end;local J={N(F,Y.Id,s,false)}aT(F,J,Z,false)return table[a.cE](J,'')end;local function aY(F,Y,ar)if ar==nil or#ar==0 then return''end;local J={N(F,Y.Id,s,true)}local ah=0;local a0=#ar;for m,Z in ipairs(ar)do if Z==nil or type(Z)~=a.bi then Z=0 end;aT(F,J,Z,m~=a0)end;return table[a.cE](J,'')end;local function aZ(ah)local a_={}a_[a.dk]=h(ah,a6)~=0;a_[a.dE]=i(h(ah,aM),5)a_[a.dD]=a_[a.dE]>0;a_[a.dF]=i(h(ah,aN),3)+1;a_[a.dM]=h(ah,aO)~=0;a_[a.dN]=i(h(ah,aP),1)+1;a_[a.dl]=h(ah,aQ)~=0;return a_ end;local function b0(al,a_)local aD,aE,b1;local aj=a_[a.dk]local aI=a_[a.dE]local aJ=a_[a.dF]local b2=0;if a_[a.dD]then b2=aI+aJ+1;if aI==1 then aD=al[1]elseif aI==2 then aD=g(j(al[1],8),al[2])else aD=g(j(al[1],16),g(j(al[2],8),al[3]))end;if aJ==1 then aE=al[aI+1]elseif aJ==2 then aE=g(j(al[aI+1],8),al[aI+2])elseif aJ==3 then aE=g(j(al[aI+1],16),g(j(al[aI+2],8),al[aI+3]))else aE=g(j(al[aI+1],24),g(j(al[aI+2],16),g(j(al[aI+3],8),al[aI+4])))end;b1=(aD+1)*af+aE else b2=aJ+1;if aJ==1 then b1=al[1]elseif aJ==2 then b1=g(j(al[1],8),al[2])elseif aJ==3 then b1=g(j(al[1],16),g(j(al[2],8),al[3]))else b1=g(j(al[1],24),g(j(al[2],16),g(j(al[3],8),al[4])))end end;local Z;if a_[a.dM]then local aW;if a_[a.dN]==1 then aW=al[b2]else aW=g(j(al[b2],8),al[b2+1])end;Z=b1+aW/10000 else Z=b1 end;if aj then Z=-1*Z end;return Z end;local Q={}Q[a.dO]=aX;Q[a.dP]=aZ;Q[a.dQ]=b0;Q[a.dR]=aY;return Q end;d[6]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local H=R[a.cJ]local N=R[a.cL]local t=R[a.cS]local av=e(3)local ac=av[a.dt]local b3=128;local b4=127;local b5=127;local b6=32767;local function b7(F,Y,Z)if Z==nil or type(Z)~=a.aZ then return''end;local a0=utf8.len(Z)if a0==0 then return''end;local b8=Y[a.dT]if a0>b8 then Z=string.sub(Z,1,b8)a0=b8 end;local J={N(F,Y.Id,t,false)}local ah=0;if a0<=b5 then ah=g(ah,a0)ah=g(ah,b3)J[#J+1]=H(F,ah)else ah=a0;J[#J+1]=H(F,h(i(a0,8),0xFF))J[#J+1]=H(F,h(a0,0xFF))end;J[#J+1]=Z;return table[a.cE](J,'')end;local function b9(ba)local J={}if h(ba,b3)~=0 then J[a.dV]=true;J.Size=h(ba,b4)else J[a.dV]=false;J.Byte=h(ba,b4)end;return J end;local function bb(bc,bd)bd.Size=g(j(bd.Byte,8),bc)return bd end;local function be(F,Y,ar)if ar==nil or table.getn(ar)==0 then return''end;local a5=math.min(ac,#ar)local J={N(F,Y.Id,t,true),H(F,a5)}local b8=Y[a.dT]for m=1,a5 do local Z=ar[m]if Z==nil or type(Z)~=a.aZ then Z=''end;local a0=utf8.len(Z)if a0>b8 then Z=string.sub(Z,1,b8)a0=b8 end;local ah=0;if a0<=b5 then ah=a0;ah=g(ah,b3)J[#J+1]=H(F,ah)else ah=a0;J[#J+1]=H(F,h(i(ah,8),0xFF))J[#J+1]=H(F,h(ah,0xFF))end;J[#J+1]=Z end;return table[a.cE](J,'')end;local Q={}Q[a.dY]=b7;Q[a.dZ]=b9;Q[a.ea]=bb;Q[a.eb]=be;Q[a.ec]=b6;return Q end;d[7]=function()local bf=Vector3.new(0,0,0)local bg={[Vector3]={{a.aW,bf,function(bh,Y,Z)local J={}if typeof(Z)~=a.bD then J[#J+1]=0;J[#J+1]=0;J[#J+1]=0 else J[#J+1]=Z.X;J[#J+1]=Z.Y;J[#J+1]=Z.Z end;return J end,function(bh,Y,Z)if Z==nil then return bf end;return Vector3.new(Z[1],Z[2],Z[3])end},{a.aW,{},function(bh,Y,Z)local J={}for as,bi in ipairs(Z)do if typeof(bi)~=a.bD then J[#J+1]=0;J[#J+1]=0;J[#J+1]=0 else J[#J+1]=bi.X;J[#J+1]=bi.Y;J[#J+1]=bi.Z end end;return J end,function(bh,Y,Z)local J={}if Z==nil or#Z==0 then return J end;for m=1,#Z,3 do J[#J+1]=Vector3.new(Z[m],Z[m+1],Z[m+2])end;return J end}}}return bg end;do local g,h,i,j=bit32.bor,bit32.band,bit32[a.cx],bit32[a.cy]local R=e(1)local B=R[a.cG]local E=R[a.cH]local G=R[a.cI]local H=R[a.cJ]local K=R[a.cK]local N=R[a.cL]local P=R[a.cM]local o=R[a.cN]local p=R[a.cO]local q=R[a.cP]local r=R[a.cQ]local s=R[a.cR]local t=R[a.cS]local u=R[a.cT]local v=R[a.cU]local z=R[a.cV]local A=R[a.cW]local n=R[a.cX]local bj=e(2)local X=bj[a.da]local _=bj[a.db]local a3=bj[a.dc]local av=e(3)local ag=av[a.dn]local ai=av[a._do]local ak=av[a.dp]local aq=av[a.dq]local at=av[a.dr]local aL=e(4)local aF=aL[a.dH]local aG=aL[a.dI]local aH=aL[a.dJ]local aK=aL[a.dK]local bk=e(5)local aX=bk[a.dO]local aZ=bk[a.dP]local b0=bk[a.dQ]local aY=bk[a.dR]local bl=e(6)local b6=bl[a.ec]local b7=bl[a.dY]local b9=bl[a.dZ]local bb=bl[a.ea]local be=bl[a.eb]local bm=e(7)local bn={}local bo;local function bp(F,Y,Z)if Z==nil or Y[a.ed]==nil then return''end;return table[a.cE]({N(F,Y.Id,u,false),bo(Z,Y[a.ed],false)},'')end;local function bq(F,Y,ar)local bh=Y[a.ed]if ar==nil or bh==nil or table.getn(ar)==0 then return''end;local a0=#ar;local J={N(F,Y.Id,u,true)}for m,Z in ipairs(ar)do J[#J+1]=bo(Z,bh,m~=a0)end;return table[a.cE](J,'')end;local function br(bs,Z,bh,bt)if bh~=nil then local Y=bh[a.ee][bt.Id]if Y~=nil then if Y.Type==bt.Type and Y[a.eg]==bt[a.eg]then if Y[a.eh]~=nil then Z=Y[a.eh](bh,Y,Z)end;bs[Y.Name]=Z else print(table[a.cE]({a.bI,a.bJ,bh.Id,', ',a.bL,Y.Id,', ',a.bN,Y.Name,', ',a.bP,B(Y.Type,Y[a.eg]),', ',a.bR,B(bt.Type,bt[a.eg]),')'},''))end end end end;bo=function(bu,bh,aC)if bu==nil then print(a.bU..bh.Name..')')return''end;local F={index=1,byte=z,content={}}local J={'',H(F,bh.Id)}local Z,bv;for as,Y in ipairs(bh[a.ej])do Z=bu[Y.Name]if Z~=nil then if Y[a.ek]~=nil then Z=Y[a.ek](bh,Y,Z)end;if Z~=nil then bv=Y[a.el](F,Y,Z)if bv~=''then J[#J+1]=bv end end end end;J[#J+1]=N(F,0,v,aC)if#J==2 then return''end;G(F)J[1]=F[a.cC]return table[a.cE](J,'')end;local function bw(bv,bx)local F={shift={},index=1}local bt=nil;local by=true;local bz=false;local bA=nil;local bh=nil;local bB=false;local bC=nil;local bD=false;local bE=0;local bF={}local bG=false;local bH={}local bI=0;local bJ=nil;local Z=nil;local bK={}local bL={}local m=0;for L in bv:gmatch(utf8[a.em])do m=m+1;if by then if L==n then by=false else local I=string.byte(L)if I==62 then I=92 end;if I==63 then I=127 end;if I>127 or I<64 then error(a.cb..L..a.cc..m)end;for as,bM in ipairs(A)do if h(I,bM)==0 then if bz then table[a.cZ](F[a.cF],1)bz=false else table[a.cZ](F[a.cF],0)end else if bz then table[a.cZ](F[a.cF],2)bz=false else bz=true end end end end elseif bA==nil then bA=K(F,L)bh=bn[bA]if bh==nil and bx~=true then print(a.cd..bA..')')return nil end elseif bB then bB=false;local bN=K(F,L)if bt.Type==q then if bt[a.eg]then bC=at(bN)if Z==nil then Z={}end;bD=true;bF={}bE=bC[a.dm][1][a.dj]bC[a.en]=1 else bC=ai(bN)if bC[a.dh]then br(bK,bC[a.di],bh,bt)Z=nil;bC=nil else bD=true;bF={}bE=bC[a.dj]end end elseif bt.Type==r then bC=aG(bN)bD=true;bF={}if bC[a.dD]then bE=bC[a.dE]+bC[a.dF]else bE=bC[a.dE]end;if bt[a.eg]then if Z==nil then Z={}end end elseif bt.Type==s then bC=aZ(bN)bD=true;bF={}if bC[a.dD]then bE=bC[a.dE]+bC[a.dF]else bE=bC[a.dF]end;if bC[a.dM]then bE=bE+bC[a.dN]end;if bt[a.eg]then if Z==nil then Z={}end end elseif bt.Type==t then if bt[a.eg]and bt[a.eo]==nil then bt[a.eo]=bN;Z={}bB=true else if bC==nil then bC=b9(bN)if bC[a.dV]then bG=true;bH={}bE=bC.Size;if bt[a.eg]then bt[a.eo]=bt[a.eo]-1 end else bB=true end else bC=bb(bN,bC)bG=true;bH={}bE=bC.Size;if bt[a.eg]then bt[a.eo]=bt[a.eo]-1 end end end end elseif bD then bF[#bF+1]=K(F,L)bE=bE-1;if bE==0 then bD=false;if bt.Type==q then if bt[a.eg]then Z[#Z+1]=ak(bF,bC[a.dm][bC[a.en]][a.dk])if bC[a.dm][bC[a.en]][a.dl]then bC[a.en]=bC[a.en]+1;if bC[a.en]>2 then bB=true else bD=true;bF={}bE=bC[a.dm][2][a.dj]end else br(bK,Z,bh,bt)Z=nil;bC=nil end else Z=ak(bF,bC[a.dk])br(bK,Z,bh,bt)Z=nil;bC=nil end elseif bt.Type==r then if bt[a.eg]then if bC[a.dD]then Z[#Z+1]=aH(bF,bC[a.dk],bC[a.dE],bC[a.dF])else Z[#Z+1]=ak(bF,bC[a.dk])end;if bC[a.dl]then bB=true else br(bK,Z,bh,bt)Z=nil;bC=nil end else if bC[a.dD]then Z=aH(bF,bC[a.dk],bC[a.dE],bC[a.dF])else Z=ak(bF,bC[a.dk])end;br(bK,Z,bh,bt)Z=nil;bC=nil end elseif bt.Type==s then if bt[a.eg]then Z[#Z+1]=b0(bF,bC)if bC[a.dl]then bB=true else br(bK,Z,bh,bt)Z=nil;bC=nil end else Z=b0(bF,bC)br(bK,Z,bh,bt)Z=nil;bC=nil end elseif bt.Type==p then local aC=a3(bF[1],Z)if aC then bD=true;bF={}bE=1 else br(bK,Z,bh,bt)Z=nil;bt=nil;bC=nil end end end elseif bG then bH[#bH+1]=L;bE=bE-1;if bE==0 then bG=false;if bt.Type==t then if bt[a.eg]then Z[#Z+1]=table[a.cE](bH,'')if bt[a.eo]>0 then bB=true else br(bK,Z,bh,bt)Z=nil;bt=nil end else Z=table[a.cE](bH,'')br(bK,Z,bh,bt)Z=nil;bt=nil end;bC=nil end end else bt=P(K(F,L))bB=true;if bt.Type==o then Z=bt[a.eg]bt[a.eg]=false;br(bK,Z,bh,bt)Z=nil;bB=false elseif bt.Type==p then Z={}bD=true;bF={}bE=1;bB=false elseif bt.Type==u then bB=false;if bt[a.eg]then Z={}else Z=nil end;local au={}au[a.ep]=F;au[a.eq]=bt;au[a.er]=by;au[a.es]=bz;au[a.et]=bA;au[a.eu]=bh;au[a.ev]=bB;au[a.ew]=bC;au[a.ex]=bD;au[a.ey]=bE;au[a.ez]=bF;au[a.eA]=bI;au[a.eB]=bJ;au[a.eC]=Z;au[a.eD]=bK;au[a.eE]=bG;au[a.eF]=bH;table[a.cZ](bL,au)F={shift={},index=1}bt=nil;by=true;bz=false;bA=nil;bh=nil;bB=false;bC=nil;bD=false;bE=0;bF={}bI=0;bJ=nil;Z=nil;bK={}bG=false;bH={}elseif bt.Type==v then bB=false;if bh~=nil then for as,Y in ipairs(bh[a.ej])do local bO=Y.Name;if bK[bO]==nil then bK[bO]=Y[a.eG]end end end;local bP=bL[#bL]if bP~=nil then if bP[a.eq][a.eg]then table[a.cZ](bP[a.eC],bK)local aC=bt[a.eg]if aC then F={shift={},index=1}bt=nil;by=true;bz=false;bA=nil;bh=nil;bB=false;bC=nil;bD=false;bE=0;bF={}bI=0;bJ=nil;Z=nil;bK={}bG=false;bH={}else F=bP[a.ep]bt=bP[a.eq]by=bP[a.er]bz=bP[a.es]bA=bP[a.et]bh=bP[a.eu]bB=bP[a.ev]bC=bP[a.ew]bD=bP[a.ex]bE=bP[a.ey]bF=bP[a.ez]bI=bP[a.eA]bJ=bP[a.eB]Z=bP[a.eC]bK=bP[a.eD]bG=bP[a.eE]bH=bP[a.eF]table[a.eH](bL,#bL)br(bK,Z,bh,bt)Z=nil end else table[a.eH](bL,#bL)br(bP[a.eD],bK,bP[a.eu],bP[a.eq])F=bP[a.ep]bt=bP[a.eq]by=bP[a.er]bz=bP[a.es]bA=bP[a.et]bh=bP[a.eu]bB=bP[a.ev]bC=bP[a.ew]bD=bP[a.ex]bE=bP[a.ey]bF=bP[a.ez]bI=bP[a.eA]bJ=bP[a.eB]Z=bP[a.eC]bK=bP[a.eD]bG=bP[a.eE]bH=bP[a.eF]end end end end end;return bK end;local bQ={}bQ[a.eI]=bQ;local function bR(C,Y,bS)local bT=bS[a.eG]local b8=bS[a.dT]if C==a.aT then Y[a.el]=ag;Y.Type=q;if bT==nil then bT=0 end elseif C==a.aS then Y[a.eg]=true;Y[a.el]=aq;Y.Type=q;if bT==nil then bT={}end elseif C==a.aV then Y[a.el]=aF;Y.Type=r;if bT==nil then bT=0 end elseif C==a.aU then Y[a.eg]=true;Y[a.el]=aK;Y.Type=r;if bT==nil then bT={}end elseif C==a.aX then Y[a.el]=aX;Y.Type=s;if bT==nil then bT=0.0 end elseif C==a.aW then Y[a.eg]=true;Y[a.el]=aY;Y.Type=s;if bT==nil then bT={}end elseif C==a.aQ then Y[a.el]=X;Y.Type=o;if bT==nil then bT=false end elseif C==a.aR then Y[a.eg]=true;Y[a.el]=_;Y.Type=p;if bT==nil then bT={}end elseif C==a.aZ or C==a.aY then Y.Type=t;Y[a.dT]=b6;local b8=b8;if b8~=nil and type(b8)==a.bi then Y[a.dT]=math[a.dC](b8)if Y[a.dT]<=0 then Y[a.dT]=b6 end;Y[a.dT]=math.min(Y[a.dT],b6)end;if C==a.aZ then Y[a.el]=b7;if bT==nil then bT=''end else Y[a.eg]=true;Y[a.el]=be;if bT==nil then bT={}end end else return false end;Y[a.eG]=bT;return true end;function bQ:Field(bU,bO,C,bS)if bS==nil then bS={}end;if bU==nil or type(bU)~=a.bi or math[a.dC](bU)~=bU or bU<0 or bU>16 then error(a.ci)end;if bO==nil or type(bO)~=a.aZ or bO==''then error(a.ck)end;if C==nil then error(a.cl)end;for as,Y in ipairs(self[a.ej])do if Y.Name==bO then error(a.cm..bO)end;if Y.Id==bU then error(a.cn..bU)end end;local Y={}Y.Id=bU;Y.Name=bO;Y[a.eg]=false;if bR(C,Y,bS)then elseif C[a.eJ]then Y.Type=u;Y[a.ed]=C;if bS[a.eg]then Y[a.eg]=true;Y[a.el]=bq else Y[a.el]=bp end else local bV=bm[C]if bV==nil then error(a.co)end;if bS[a.eg]then bR(bV[2][1],Y,bS)Y[a.eG]=bV[2][2]Y[a.ek]=bV[2][3]Y[a.eh]=bV[2][4]else bR(bV[1][1],Y,bS)Y[a.eG]=bV[1][2]Y[a.ek]=bV[1][3]Y[a.eh]=bV[1][4]end end;if Y[a.ek]==nil and type(bS[a.eK])==a.cp then Y[a.ek]=bS[a.eK]end;if Y[a.eh]==nil and type(bS[a.eL])==a.cp then Y[a.eh]=bS[a.eL]end;table[a.cZ](self[a.ej],Y)self[a.ee][Y.Id]=Y;return self end;function bQ:Encoder(bW)if type(bW)~=a.cp then error(a.cq)end;self[a.eM]=bW;return self end;function bQ:Decoder(bW)if type(bW)~=a.cp then error(a.cr)end;self[a.eN]=bW;return self end;function bQ:Serialize(bu)return bo(bu,self,false)end;local function bX(bU)if type(bU)==a.bi then if bU<0 or bU>254 then error(a.cs)end;if bn[bU]~=nil then print(bn[bU],bn)error(a.ct)end;local bh={}bh[a.eJ]=true;bh.Id=bU;bh[a.ej]={}bh[a.ee]={}setmetatable(bh,bQ)bn[bU]=bh;return bh else local bY=bU;local bh=bX(bY.Id)end end;local bZ={}bZ[a.ed]=bX;bZ[a.eO]=bw;return bZ end end
