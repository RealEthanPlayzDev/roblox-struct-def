--[[
   Roblox StructDef v1.0.0 [2021-02-28 22:10]

   The Structure Definition, or simply StructDef, is a library that allows the 
   serialization and deserialization of structured data. You define how you want 
   your data to be structured once and then you can use the generated instance 
   to easily write and read your structured data to and from a UTF-8 string.
   
   This is a minified version of Roblox StructDef, to see the full source 
   code visit https://github.com/nidorx/roblox-struct-def

   Discussions about this script are at https://devforum.roblox.com/t/1112973

   ------------------------------------------------------------------------------

   MIT License

   Copyright (c) 2021 Alex Rodin

   Permission is hereby granted, free of charge, to any person obtaining a copy
   of this software and associated documentation files (the "Software"), to deal
   in the Software without restriction, including without limitation the rights
   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   copies of the Software, and to permit persons to whom the Software is
   furnished to do so, subject to the following conditions:

   The above copyright notice and this permission notice shall be included in all
   copies or substantial portions of the Software.

   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   SOFTWARE.
]]
do local a={aR='bool',aS='bool[]',aT='int32[]',aU='int32',aV='int53[]',aW='int53',aX='double[]',aY='double',aZ='string[]',ba='string',bb='ref[]',bd='unknown',bf='Unexpected field id ',bi='number',bD='Vector3',bI='[WARNING] Schema:Serialize - Received nil as input, skipping serialization (Name=',bP='[WARNING] StructDef:Deserialize - The type of the field is different from the serialized value (',bQ='SCHEMA_ID=',bS='FIELD_ID=',bU='FIELD_NAME=',bW='FIELD_TYPE=',bY='CONTENT_FIELD_TYPE=',cb='Unexpected value (',cc=') in the header at position ',cd='[WARNING] StructDef:Deserialize - Content references to an unregistered schema (SCHEMA_ID=',ci='Field Id must be an integer between 0 and 15',ck='Field Name must be a valid string',cl='Field data type is required',cm='A registered field with the same name already exists ',cn='There is already a registered field with the same id ',co='Field data type is invalid',cp='function',cq='The schema id must be> = 0 and <= 254',cr='There is already a registered schema with the given Id',cv='rshift',cw='lshift',cy='index',cA='content',cC='concat',cD='shift',cE='get_field_type_name',cF='header_increment',cG='header_flush',cH='encode_byte',cI='decode_char',cJ='encode_field',cK='decode_field_byte',cL='FIELD_TYPE_BITMASK_BOOL',cM='FIELD_TYPE_BITMASK_BOOL_ARRAY',cN='FIELD_TYPE_BITMASK_INT32',cO='FIELD_TYPE_BITMASK_INT53',cP='FIELD_TYPE_BITMASK_DOUBLE',cQ='FIELD_TYPE_BITMASK_STRING',cR='FIELD_TYPE_BITMASK_SCHEMA',cS='FIELD_TYPE_BITMASK_SCHEMA_END',cT='HEADER_EMPTY_BYTE',cU='HEADER_BITMASK_INDEX',cV='HEADER_END_MARK',cX='insert',cY='encode_bool',cZ='encode_bool_array',da='decode_bool_array_byte',db='round',df='ValueFits',dg='Value',dh='Bytes',di='IsNegative',dj='HasMore',dk='Items',dl='encode_int32',dm='decode_int32_extra_byte',dn='decode_int32_bytes',_do='encode_int32_array',dp='decode_int32_array_extra_byte',dq='INT6_MAX',dr='INT8_MAX',ds='INT16_MAX',dt='INT24_MAX',du='INT32_MAX',dv='INT_EXTRA_BITMASK_NEGATIVE',dw='INT_EXTRA_BITMASK_IT_FITS',dx='INT_EXTRA_BITMASK_VALUE',dy='INT_EXTRA_BITMASK_BYTE_COUNT',dz='INT_EXTRA_BITMASK_NUM_BYTES',dA='floor',dB='IsBig',dC='BytesTimes',dD='BytesRest',dE='encode_int53_out',dF='encode_int53',dG='decode_int53_extra_byte',dH='decode_int53_bytes',dI='encode_int53_array',dJ='INT53_MAX',dK='HasDec',dL='BytesDec',dM='encode_double',dN='decode_double_extra_byte',dO='decode_double_bytes',dP='encode_double_array',dR='MaxLength',dT='SizeFits',dW='encode_string',dX='decode_string_extra_byte_first',dY='decode_string_extra_byte_second',dZ='encode_string_array',ea='STRING_MAX_SIZE',eb='Schema',ed='Fields',ee='ConvertToSerialize',ef='EncodeFn',eg='FieldsById',ei='IsArray',ej='ConvertToInstance',ek='charpattern',el='Index',em='Count',en='header',eo='fieldDecoded',ep='inHeader',eq='inHeaderBit2',er='schemaId',es='schema',et='inExtraByte',eu='extraByteDecoded',ev='isCaptureBytes',ew='captureCount',ex='capturedBytes',ey='value',ez='object',eA='isCaptureChars',eB='capturedChars',eC='Default',eD='remove',eE='__index',eF='isSchema',eG='ToSerialize',eH='ToInstance',eI='Deserialize'}local b=game:GetService('ReplicatedStorage')local c={}local d={}local e=function(f)if not c[f]then c[f]={r=d[f]()}end;return c[f].r end;d[1]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local k={"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"}k[0]='!'local l={}for m=0,table.getn(k)do l[k[m]]=m end;local n='<'local o=0;local p=32;local q=64;local r=96;local s=128;local t=160;local u=192;local v=224;local w=15;local x=16;local y=224;local z=64;local n='='local A={32,16,8,4,2,1}local function B(C,D)if C==o then return a.aR elseif C==p then return a.aS elseif C==q then if D then return a.aT else return a.aU end elseif C==r then if D then return a.aV else return a.aW end elseif C==s then if D then return a.aX else return a.aY end elseif C==t then if D then return a.aZ else return a.ba end elseif C==u then if D then return a.bb else return'ref'end else return a.bd end end;local function E(F)if F[a.cy]>6 then if F.byte==92 then F.byte=62 end;if F.byte==127 then F.byte=63 end;F[a.cA][#F[a.cA]+1]=string.char(F.byte)F.byte=z;F[a.cy]=1 end end;local function G(F)if F[a.cy]>1 then F[a.cy]=7;E(F)end;F[a.cA][#F[a.cA]+1]=n;F[a.cA]=table[a.cC](F[a.cA],'')end;local function H(F,I)local J;if I<92 then J=k[I]F[a.cy]=F[a.cy]+1 elseif I<184 then J=k[I-92]F.byte=g(F.byte,A[F[a.cy]])F[a.cy]=F[a.cy]+1;E(F)F[a.cy]=F[a.cy]+1 else J=k[I-184]F.byte=g(F.byte,A[F[a.cy]])F[a.cy]=F[a.cy]+1;E(F)F.byte=g(F.byte,A[F[a.cy]])F[a.cy]=F[a.cy]+1 end;E(F)return J end;local function K(F,L)local I=l[L]local M=F[a.cD][F[a.cy]]F[a.cy]=F[a.cy]+1;if M==0 then return I elseif M==1 then return I+92 else return I+184 end end;local function N(F,O,C,D)if O>16 or O<0 then error(a.bf..O)end;local I=g(O,C)if D then I=g(I,x)end;return H(F,I)end;local function P(I)return{Id=h(I,w),Type=h(I,y),IsArray=h(I,x)~=0}end;local Q={}Q[a.cE]=B;Q[a.cF]=E;Q[a.cG]=G;Q[a.cH]=H;Q[a.cI]=K;Q[a.cJ]=N;Q[a.cK]=P;Q[a.cL]=o;Q[a.cM]=p;Q[a.cN]=q;Q[a.cO]=r;Q[a.cP]=s;Q[a.cQ]=t;Q[a.cR]=u;Q[a.cS]=v;Q[a.cT]=z;Q[a.cU]=A;Q[a.cV]=n;return Q end;d[2]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local H=Q[a.cH]local N=Q[a.cJ]local o=Q[a.cL]local p=Q[a.cM]local R=192;local S=16;local T=1;local U={0,64,128,192}local V={32,16,8,4}local function W(F,X,Y)return N(F,X.Id,o,Y==true)end;local function Z(F,X,Y)local _=table.getn(Y)if Y==nil or _==0 then return''end;local J={}local a0=0;local I=0;for m,a1 in ipairs(Y)do a0=a0+1;if a0>4 then I=g(I,U[4])if m<_ then I=g(I,1)end;if#J==0 then J[#J+1]=N(F,X.Id,p,true)end;J[#J+1]=H(F,I)I=0;a0=1 end;if a1 then I=g(I,V[a0])end end;if a0>0 then I=g(I,U[a0])if#J==0 then J[#J+1]=N(F,X.Id,p,true)end;J[#J+1]=H(F,I)end;return table[a.cC](J,'')end;local function a2(I,a3)local a4=i(h(I,R),6)+1;for a0=1,a4 do table[a.cX](a3,h(I,V[a0])>0)end;return h(I,T)>0 end;local a5={}a5[a.cY]=W;a5[a.cZ]=Z;a5[a.da]=a2;return a5 end;d[3]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local H=Q[a.cH]local N=Q[a.cJ]local q=Q[a.cN]local a6=128;local a7=64;local a8=63;local a9=12;local aa={0,4,8,12}local ab=63;local ac=255;local ad=65535;local ae=16777215;local af=4294967295;local function ag(F,X,Y)if Y==nil or type(Y)~=a.bi then return''end;Y=math[a.db](Y)if Y==0 then return''end;local J={N(F,X.Id,q,false)}local ah=0;if Y<0 then ah=g(ah,a6)end;Y=math.min(af,math.max(0,math.abs(Y)))if Y<=ab then ah=g(ah,Y)ah=g(ah,a7)J[#J+1]=H(F,ah)elseif Y<=ac then ah=g(ah,aa[1])J[#J+1]=H(F,ah)J[#J+1]=H(F,Y)elseif Y<=ad then ah=g(ah,aa[2])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))elseif Y<=ae then ah=g(ah,aa[3])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,16),0xFF))J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))else ah=g(ah,aa[4])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,24),0xFF))J[#J+1]=H(F,h(i(Y,16),0xFF))J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))end;return table[a.cC](J,'')end;local function ai(ah)local J={}local aj=h(ah,a6)~=0;if h(ah,a7)~=0 then local Y=h(ah,a8)if aj then Y=-1*Y end;J[a.df]=true;J[a.dg]=Y else J[a.dh]=i(h(ah,a9),2)+1;J[a.df]=false;J[a.di]=aj end;return J end;local function ak(al,aj)local _=#al;local Y;if _==1 then Y=al[1]elseif _==2 then Y=g(j(al[1],8),al[2])elseif _==3 then Y=g(j(al[1],16),g(j(al[2],8),al[3]))else Y=g(j(al[1],24),g(j(al[2],16),g(j(al[3],8),al[4])))end;if aj then Y=-1*Y end;return Y end;local am={32,2}local an={16,1}local ao={{192,6},{12,2}}local ap={{0,64,128,192},{0,4,8,12}}local function aq(F,X,ar)if ar==nil or#ar==0 then return''end;local J={N(F,X.Id,q,true)}local ah=0;local al={}local _=#ar;local a0=1;for m,Y in ipairs(ar)do if Y==nil or type(Y)~=a.bi then Y=0 end;Y=math[a.db](Y)if Y<0 then ah=g(ah,am[a0])end;if m<_ then ah=g(ah,an[a0])end;Y=math.min(af,math.max(0,math.abs(Y)))if Y<=ac then al[#al+1]=Y elseif Y<=ad then ah=g(ah,ap[a0][2])al[#al+1]=h(i(Y,8),0xFF)al[#al+1]=h(Y,0xFF)elseif Y<=ae then ah=g(ah,ap[a0][3])al[#al+1]=h(i(Y,16),0xFF)al[#al+1]=h(i(Y,8),0xFF)al[#al+1]=h(Y,0xFF)else ah=g(ah,ap[a0][4])al[#al+1]=h(i(Y,24),0xFF)al[#al+1]=h(i(Y,16),0xFF)al[#al+1]=h(i(Y,8),0xFF)al[#al+1]=h(Y,0xFF)end;a0=a0+1;if a0>2 then J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end;a0=1;ah=0;al={}end end;if a0>1 then J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end;return table[a.cC](J,'')end;local function at(ah)local J={}local au={}au[a.dh]=i(h(ah,ao[1][1]),ao[1][2])+1;au[a.di]=h(ah,am[1])~=0;au[a.dj]=h(ah,an[1])~=0;J[a.dk]={au}if J[a.dk][1][a.dj]then local au={}au[a.dh]=i(h(ah,ao[2][1]),ao[2][2])+1;au[a.di]=h(ah,am[2])~=0;au[a.dj]=h(ah,an[2])~=0;table[a.cX](J[a.dk],au)end;return J end;local av={}av[a.dl]=ag;av[a.dm]=ai;av[a.dn]=ak;av[a._do]=aq;av[a.dp]=at;av[a.dq]=ab;av[a.dr]=ac;av[a.ds]=ad;av[a.dt]=ae;av[a.du]=af;av[a.dv]=a6;av[a.dw]=a7;av[a.dx]=a8;av[a.dy]=a9;av[a.dz]=aa;return av end;d[4]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local H=Q[a.cH]local N=Q[a.cJ]local r=Q[a.cO]local aw=e(3)local ab=aw[a.dq]local ac=aw[a.dr]local ad=aw[a.ds]local ae=aw[a.dt]local af=aw[a.du]local a6=aw[a.dv]local a9=aw[a.dy]local aa=aw[a.dz]local ax=9007199254740991;local ay=32;local az=16;local aA=3;local aB={0,1,2,3}local function aC(F,J,Y,aD)local ah=0;if Y<0 then ah=g(ah,a6)end;if aD then ah=g(ah,az)end;Y=math.min(ax,math.max(0,math.abs(Y)))if Y<=ac then ah=g(ah,aa[1])J[#J+1]=H(F,ah)J[#J+1]=H(F,Y)elseif Y<=ad then ah=g(ah,aa[2])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))elseif Y<=ae then ah=g(ah,aa[3])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,16),0xFF))J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))elseif Y<=af then ah=g(ah,aa[4])J[#J+1]=H(F,ah)J[#J+1]=H(F,h(i(Y,24),0xFF))J[#J+1]=H(F,h(i(Y,16),0xFF))J[#J+1]=H(F,h(i(Y,8),0xFF))J[#J+1]=H(F,h(Y,0xFF))else ah=g(ah,ay)local aE=math[a.dA](Y/af)-1;local aF=Y-(aE+1)*af;local al={}if aE<=ac then al[#al+1]=aE elseif aE<=ad then ah=g(ah,aa[2])al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)else ah=g(ah,aa[3])al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)end;if aF<=ac then al[#al+1]=aF elseif aF<=ad then ah=g(ah,aB[2])al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)elseif aF<=ae then ah=g(ah,aB[3])al[#al+1]=h(i(aF,16),0xFF)al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)else ah=g(ah,aB[4])al[#al+1]=h(i(aF,24),0xFF)al[#al+1]=h(i(aF,16),0xFF)al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)end;J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end end;local function aG(F,X,Y)if Y==nil or type(Y)~=a.bi then return''end;Y=math[a.db](Y)if Y==0 then return''end;local J={N(F,X.Id,r,false)}aC(F,J,Y,false)return table[a.cC](J,'')end;local function aH(ah)local J={}J[a.di]=h(ah,a6)~=0;J[a.dB]=h(ah,ay)~=0;J[a.dj]=h(ah,az)~=0;J[a.dC]=i(h(ah,a9),2)+1;J[a.dD]=h(ah,aA)+1;return J end;local function aI(al,aj,aJ,aK)local aE,aF,Y;if aJ==1 then aE=al[1]elseif aJ==2 then aE=g(j(al[1],8),al[2])else aE=g(j(al[1],16),g(j(al[2],8),al[3]))end;if aK==1 then aF=al[aJ+1]elseif aK==2 then aF=g(j(al[aJ+1],8),al[aJ+2])elseif aK==3 then aF=g(j(al[aJ+1],16),g(j(al[aJ+2],8),al[aJ+3]))else aF=g(j(al[aJ+1],24),g(j(al[aJ+2],16),g(j(al[aJ+3],8),al[aJ+4])))end;Y=(aE+1)*af+aF;if aj then Y=-1*Y end;return Y end;local function aL(F,X,ar)if ar==nil or#ar==0 then return''end;local J={N(F,X.Id,r,true)}local ah=0;local _=#ar;for m,Y in ipairs(ar)do if Y==nil or type(Y)~=a.bi then Y=0 end;Y=math[a.db](Y)aC(F,J,Y,m~=_)end;return table[a.cC](J,'')end;local av={}av[a.dE]=aC;av[a.dF]=aG;av[a.dG]=aH;av[a.dH]=aI;av[a.dI]=aL;av[a.dJ]=ax;return av end;d[5]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local H=Q[a.cH]local N=Q[a.cJ]local s=Q[a.cP]local aw=e(3)local ab=aw[a.dq]local ac=aw[a.dr]local ad=aw[a.ds]local ae=aw[a.dt]local af=aw[a.du]local a6=aw[a.dv]local a9=aw[a.dy]local aa=aw[a.dz]local aM=e(4)local ax=aM[a.dJ]local aN=96;local aO=24;local aP=4;local aQ=2;local aR=1;local aS={0,8,16,24}local aT={0,32,64,96}local function aU(F,J,Y,aD)local ah=0;if Y<0 then ah=g(ah,a6)end;if aD then ah=g(ah,aR)end;local aV=false;Y=math.abs(Y)local aW=math[a.dA](Y)local aX=math[a.dA]((Y-aW)*10000)if aW~=Y then aV=true end;aW=math.min(ax,math.max(0,aW))local al={}if aW<=ac then al[#al+1]=aW elseif aW<=ad then ah=g(ah,aS[2])al[#al+1]=h(i(aW,8),0xFF)al[#al+1]=h(aW,0xFF)elseif aW<=ae then ah=g(ah,aS[3])al[#al+1]=h(i(aW,16),0xFF)al[#al+1]=h(i(aW,8),0xFF)al[#al+1]=h(aW,0xFF)elseif aW<=af then ah=g(ah,aS[4])al[#al+1]=h(i(aW,24),0xFF)al[#al+1]=h(i(aW,16),0xFF)al[#al+1]=h(i(aW,8),0xFF)al[#al+1]=h(aW,0xFF)else local aE=math[a.dA](aW/af)-1;local aF=aW-(aE+1)*af;if aE<=ac then ah=g(ah,aT[2])al[#al+1]=aE elseif aE<=ad then ah=g(ah,aT[3])al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)else ah=g(ah,aT[4])al[#al+1]=h(i(aE,16),0xFF)al[#al+1]=h(i(aE,8),0xFF)al[#al+1]=h(aE,0xFF)end;if aF<=ac then al[#al+1]=aF elseif aF<=ad then ah=g(ah,aS[2])al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)elseif aF<=ae then ah=g(ah,aS[3])al[#al+1]=h(i(aF,16),0xFF)al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)else ah=g(ah,aS[4])al[#al+1]=h(i(aF,24),0xFF)al[#al+1]=h(i(aF,16),0xFF)al[#al+1]=h(i(aF,8),0xFF)al[#al+1]=h(aF,0xFF)end end;if aV then ah=g(ah,aP)if aX<=ac then al[#al+1]=aX else ah=g(ah,aQ)al[#al+1]=h(i(aX,8),0xFF)al[#al+1]=h(aX,0xFF)end end;J[#J+1]=H(F,ah)for as,I in ipairs(al)do J[#J+1]=H(F,I)end end;local function aY(F,X,Y)if Y==nil or type(Y)~=a.bi or Y==0 then return''end;local J={N(F,X.Id,s,false)}aU(F,J,Y,false)return table[a.cC](J,'')end;local function aZ(F,X,ar)if ar==nil or#ar==0 then return''end;local J={N(F,X.Id,s,true)}local ah=0;local _=#ar;for m,Y in ipairs(ar)do if Y==nil or type(Y)~=a.bi then Y=0 end;aU(F,J,Y,m~=_)end;return table[a.cC](J,'')end;local function a_(ah)local b0={}b0[a.di]=h(ah,a6)~=0;b0[a.dC]=i(h(ah,aN),5)b0[a.dB]=b0[a.dC]>0;b0[a.dD]=i(h(ah,aO),3)+1;b0[a.dK]=h(ah,aP)~=0;b0[a.dL]=i(h(ah,aQ),1)+1;b0[a.dj]=h(ah,aR)~=0;return b0 end;local function b1(al,b0)local aE,aF,b2;local aj=b0[a.di]local aJ=b0[a.dC]local aK=b0[a.dD]local b3=0;if b0[a.dB]then b3=aJ+aK+1;if aJ==1 then aE=al[1]elseif aJ==2 then aE=g(j(al[1],8),al[2])else aE=g(j(al[1],16),g(j(al[2],8),al[3]))end;if aK==1 then aF=al[aJ+1]elseif aK==2 then aF=g(j(al[aJ+1],8),al[aJ+2])elseif aK==3 then aF=g(j(al[aJ+1],16),g(j(al[aJ+2],8),al[aJ+3]))else aF=g(j(al[aJ+1],24),g(j(al[aJ+2],16),g(j(al[aJ+3],8),al[aJ+4])))end;b2=(aE+1)*af+aF else b3=aK+1;if aK==1 then b2=al[1]elseif aK==2 then b2=g(j(al[1],8),al[2])elseif aK==3 then b2=g(j(al[1],16),g(j(al[2],8),al[3]))else b2=g(j(al[1],24),g(j(al[2],16),g(j(al[3],8),al[4])))end end;local Y;if b0[a.dK]then local aX;if b0[a.dL]==1 then aX=al[b3]else aX=g(j(al[b3],8),al[b3+1])end;Y=b2+aX/10000 else Y=b2 end;if aj then Y=-1*Y end;return Y end;local av={}av[a.dM]=aY;av[a.dN]=a_;av[a.dO]=b1;av[a.dP]=aZ;return av end;d[6]=function()local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local H=Q[a.cH]local N=Q[a.cJ]local t=Q[a.cQ]local aw=e(3)local ac=aw[a.dr]local b4=128;local b5=127;local b6=127;local b7=32767;local function b8(F,X,Y)if Y==nil or type(Y)~=a.ba then return''end;local _=utf8.len(Y)if _==0 then return''end;local b9=X[a.dR]if _>b9 then Y=string.sub(Y,1,b9)_=b9 end;local J={N(F,X.Id,t,false)}local ah=0;if _<=b6 then ah=g(ah,_)ah=g(ah,b4)J[#J+1]=H(F,ah)else ah=_;J[#J+1]=H(F,h(i(_,8),0xFF))J[#J+1]=H(F,h(_,0xFF))end;J[#J+1]=Y;return table[a.cC](J,'')end;local function ba(bb)local J={}if h(bb,b4)~=0 then J[a.dT]=true;J.Size=h(bb,b5)else J[a.dT]=false;J.Byte=h(bb,b5)end;return J end;local function bc(bd,be)be.Size=g(j(be.Byte,8),bd)return be end;local function bf(F,X,ar)if ar==nil or table.getn(ar)==0 then return''end;local a4=math.min(ac,#ar)local J={N(F,X.Id,t,true),H(F,a4)}local b9=X[a.dR]for m=1,a4 do local Y=ar[m]if Y==nil or type(Y)~=a.ba then Y=''end;local _=utf8.len(Y)if _>b9 then Y=string.sub(Y,1,b9)_=b9 end;local ah=0;if _<=b6 then ah=_;ah=g(ah,b4)J[#J+1]=H(F,ah)else ah=_;J[#J+1]=H(F,h(i(ah,8),0xFF))J[#J+1]=H(F,h(ah,0xFF))end;J[#J+1]=Y end;return table[a.cC](J,'')end;local bg={}bg[a.dW]=b8;bg[a.dX]=ba;bg[a.dY]=bc;bg[a.dZ]=bf;bg[a.ea]=b7;return bg end;d[7]=function()local bh=Vector3.new(0,0,0)local bi={[Vector3]={{a.aX,bh,function(bj,X,Y)local J={}if typeof(Y)~=a.bD then J[#J+1]=0;J[#J+1]=0;J[#J+1]=0 else J[#J+1]=Y.X;J[#J+1]=Y.Y;J[#J+1]=Y.Z end;return J end,function(bj,X,Y)if Y==nil then return bh end;return Vector3.new(Y[1],Y[2],Y[3])end},{a.aX,{},function(bj,X,Y)local J={}for as,bk in ipairs(Y)do if typeof(bk)~=a.bD then J[#J+1]=0;J[#J+1]=0;J[#J+1]=0 else J[#J+1]=bk.X;J[#J+1]=bk.Y;J[#J+1]=bk.Z end end;return J end,function(bj,X,Y)local J={}if Y==nil or#Y==0 then return J end;for m=1,#Y,3 do J[#J+1]=Vector3.new(Y[m],Y[m+1],Y[m+2])end;return J end}}}return bi end;do local g,h,i,j=bit32.bor,bit32.band,bit32[a.cv],bit32[a.cw]local Q=e(1)local B=Q[a.cE]local E=Q[a.cF]local G=Q[a.cG]local H=Q[a.cH]local K=Q[a.cI]local N=Q[a.cJ]local P=Q[a.cK]local o=Q[a.cL]local p=Q[a.cM]local q=Q[a.cN]local r=Q[a.cO]local s=Q[a.cP]local t=Q[a.cQ]local u=Q[a.cR]local v=Q[a.cS]local z=Q[a.cT]local A=Q[a.cU]local n=Q[a.cV]local a5=e(2)local W=a5[a.cY]local Z=a5[a.cZ]local a2=a5[a.da]local aw=e(3)local ag=aw[a.dl]local ai=aw[a.dm]local ak=aw[a.dn]local aq=aw[a._do]local at=aw[a.dp]local aM=e(4)local aG=aM[a.dF]local aH=aM[a.dG]local aI=aM[a.dH]local aL=aM[a.dI]local bl=e(5)local aY=bl[a.dM]local a_=bl[a.dN]local b1=bl[a.dO]local aZ=bl[a.dP]local bg=e(6)local b7=bg[a.ea]local b8=bg[a.dW]local ba=bg[a.dX]local bc=bg[a.dY]local bf=bg[a.dZ]local bm=e(7)local bn={}local bo;local function bp(F,X,Y)if Y==nil or X[a.eb]==nil then return''end;return table[a.cC]({N(F,X.Id,u,false),bo(Y,X[a.eb],false)},'')end;local function bq(F,X,ar)local bj=X[a.eb]if ar==nil or bj==nil or table.getn(ar)==0 then return''end;local _=#ar;local J={N(F,X.Id,u,true)}for m,Y in ipairs(ar)do J[#J+1]=bo(Y,bj,m~=_)end;return table[a.cC](J,'')end;bo=function(br,bj,aD)if br==nil then print(a.bI..bj.Name..')')return''end;local F={index=1,byte=z,content={}}local J={'',H(F,bj.Id)}local Y,bs;for as,X in ipairs(bj[a.ed])do Y=br[X.Name]if Y~=nil then if X[a.ee]~=nil then Y=X[a.ee](bj,X,Y)end;if Y~=nil then bs=X[a.ef](F,X,Y)if bs~=''then J[#J+1]=bs end end end end;J[#J+1]=N(F,0,v,aD)if#J==3 then return''end;G(F)J[1]=F[a.cA]return table[a.cC](J,'')end;local function bt(bu,Y,bj,bv)if bj~=nil then local X=bj[a.eg][bv.Id]if X~=nil then if X.Type==bv.Type and X[a.ei]==bv[a.ei]then if X[a.ej]~=nil then Y=X[a.ej](bj,X,Y)end;bu[X.Name]=Y else print(table[a.cC]({a.bP,a.bQ,bj.Id,', ',a.bS,X.Id,', ',a.bU,X.Name,', ',a.bW,B(X.Type,X[a.ei]),', ',a.bY,B(bv.Type,bv[a.ei]),')'},''))end end end end;local function bw(bs,bx)local F={shift={},index=1}local bv=nil;local by=true;local bz=false;local bA=nil;local bj=nil;local bB=false;local bC=nil;local bD=false;local bE={}local bF=false;local bG={}local bH=0;local Y=nil;local bu={}local bI={}local m=0;local bJ={}for L in bs:gmatch(utf8[a.ek])do m=m+1;if by then if L==n then by=false else local I=string.byte(L)if I==62 then I=92 end;if I==63 then I=127 end;if I>127 or I<64 then error(a.cb..L..a.cc..m)end;for as,bK in ipairs(A)do if h(I,bK)==0 then if bz then table[a.cX](F[a.cD],1)bz=false else table[a.cX](F[a.cD],0)end else if bz then table[a.cX](F[a.cD],2)bz=false else bz=true end end end end elseif bA==nil then bA=K(F,L)bj=bn[bA]if bj==nil and bx~=true then print(a.cd..bA..')')return nil end elseif bB then bB=false;local bL=K(F,L)if bv.Type==q then if bv[a.ei]then bC=at(bL)if Y==nil then Y={}end;bD=true;bE={}bH=bC[a.dk][1][a.dh]bC[a.el]=1 else bC=ai(bL)if bC[a.df]then bt(bu,bC[a.dg],bj,bv)Y=nil;bC=nil else bD=true;bE={}bH=bC[a.dh]end end elseif bv.Type==r then bC=aH(bL)bD=true;bE={}if bC[a.dB]then bH=bC[a.dC]+bC[a.dD]else bH=bC[a.dC]end;if bv[a.ei]then if Y==nil then Y={}end end elseif bv.Type==s then bC=a_(bL)bD=true;bE={}if bC[a.dB]then bH=bC[a.dC]+bC[a.dD]else bH=bC[a.dD]end;if bC[a.dK]then bH=bH+bC[a.dL]end;if bv[a.ei]then if Y==nil then Y={}end end elseif bv.Type==t then if bv[a.ei]and bv[a.em]==nil then bv[a.em]=bL;Y={}bB=true else if bC==nil then bC=ba(bL)if bC[a.dT]then bF=true;bG={}bH=bC.Size;if bv[a.ei]then bv[a.em]=bv[a.em]-1 end else bB=true end else bC=bc(bL,bC)bF=true;bG={}bH=bC.Size;if bv[a.ei]then bv[a.em]=bv[a.em]-1 end end end end elseif bD then bE[#bE+1]=K(F,L)bH=bH-1;if bH==0 then bD=false;if bv.Type==q then if bv[a.ei]then Y[#Y+1]=ak(bE,bC[a.dk][bC[a.el]][a.di])if bC[a.dk][bC[a.el]][a.dj]then bC[a.el]=bC[a.el]+1;if bC[a.el]>2 then bB=true else bD=true;bE={}bH=bC[a.dk][2][a.dh]end else bt(bu,Y,bj,bv)Y=nil;bC=nil end else Y=ak(bE,bC[a.di])bt(bu,Y,bj,bv)Y=nil;bC=nil end elseif bv.Type==r then if bv[a.ei]then if bC[a.dB]then Y[#Y+1]=aI(bE,bC[a.di],bC[a.dC],bC[a.dD])else Y[#Y+1]=ak(bE,bC[a.di])end;if bC[a.dj]then bB=true else bt(bu,Y,bj,bv)Y=nil;bC=nil end else if bC[a.dB]then Y=aI(bE,bC[a.di],bC[a.dC],bC[a.dD])else Y=ak(bE,bC[a.di])end;bt(bu,Y,bj,bv)Y=nil;bC=nil end elseif bv.Type==s then if bv[a.ei]then Y[#Y+1]=b1(bE,bC)if bC[a.dj]then bB=true else bt(bu,Y,bj,bv)Y=nil;bC=nil end else Y=b1(bE,bC)bt(bu,Y,bj,bv)Y=nil;bC=nil end elseif bv.Type==p then local aD=a2(bE[1],Y)if aD then bD=true;bE={}bH=1 else bt(bu,Y,bj,bv)Y=nil;bv=nil;bC=nil end end end elseif bF then bG[#bG+1]=L;bH=bH-1;if bH==0 then bF=false;if bv.Type==t then if bv[a.ei]then Y[#Y+1]=table[a.cC](bG,'')if bv[a.em]>0 then bB=true else bt(bu,Y,bj,bv)Y=nil;bv=nil end else Y=table[a.cC](bG,'')bt(bu,Y,bj,bv)Y=nil;bv=nil end;bC=nil end end else bv=P(K(F,L))bB=true;if bv.Type==o then Y=bv[a.ei]bv[a.ei]=false;bt(bu,Y,bj,bv)Y=nil;bB=false elseif bv.Type==p then Y={}bD=true;bE={}bH=1;bB=false elseif bv.Type==u then bB=false;if bv[a.ei]then Y={}else Y=nil end;local au={}au[a.en]=F;au[a.eo]=bv;au[a.ep]=by;au[a.eq]=bz;au[a.er]=bA;au[a.es]=bj;au[a.et]=bB;au[a.eu]=bC;au[a.ev]=bD;au[a.ew]=bH;au[a.ex]=bE;au[a.ey]=Y;au[a.ez]=bu;au[a.eA]=bF;au[a.eB]=bG;table[a.cX](bI,au)F={shift={},index=1}bv=nil;by=true;bz=false;bA=nil;bj=nil;bB=false;bC=nil;bD=false;bH=0;bE={}Y=nil;bu={}bF=false;bG={}elseif bv.Type==v then bB=false;if bj~=nil then for as,X in ipairs(bj[a.ed])do local bM=X.Name;if bu[bM]==nil then bu[bM]=X[a.eC]end end end;local bN=bI[#bI]if bN==nil then if bx==true then table[a.cX](bJ,bu)else return bu end else if bN[a.eo][a.ei]then table[a.cX](bN[a.ey],bu)local aD=bv[a.ei]if aD then F={shift={},index=1}bv=nil;by=true;bz=false;bA=nil;bj=nil;bB=false;bC=nil;bD=false;bH=0;bE={}Y=nil;bu={}bF=false;bG={}else F=bN[a.en]bv=bN[a.eo]by=bN[a.ep]bz=bN[a.eq]bA=bN[a.er]bj=bN[a.es]bB=bN[a.et]bC=bN[a.eu]bD=bN[a.ev]bH=bN[a.ew]bE=bN[a.ex]Y=bN[a.ey]bu=bN[a.ez]bF=bN[a.eA]bG=bN[a.eB]table[a.eD](bI,#bI)bt(bu,Y,bj,bv)Y=nil end else table[a.eD](bI,#bI)bt(bN[a.ez],bu,bN[a.es],bN[a.eo])F=bN[a.en]bv=bN[a.eo]by=bN[a.ep]bz=bN[a.eq]bA=bN[a.er]bj=bN[a.es]bB=bN[a.et]bC=bN[a.eu]bD=bN[a.ev]bH=bN[a.ew]bE=bN[a.ex]Y=bN[a.ey]bu=bN[a.ez]bF=bN[a.eA]bG=bN[a.eB]end end end end end;if bx==true then return bJ end;return bu end;local bO={}bO[a.eE]=bO;local function bP(C,X,bQ)local bR=bQ[a.eC]local b9=bQ[a.dR]if C==a.aU then X[a.ef]=ag;X.Type=q;if bR==nil then bR=0 end elseif C==a.aT then X[a.ei]=true;X[a.ef]=aq;X.Type=q;if bR==nil then bR={}end elseif C==a.aW then X[a.ef]=aG;X.Type=r;if bR==nil then bR=0 end elseif C==a.aV then X[a.ei]=true;X[a.ef]=aL;X.Type=r;if bR==nil then bR={}end elseif C==a.aY then X[a.ef]=aY;X.Type=s;if bR==nil then bR=0.0 end elseif C==a.aX then X[a.ei]=true;X[a.ef]=aZ;X.Type=s;if bR==nil then bR={}end elseif C==a.aR then X[a.ef]=W;X.Type=o;if bR==nil then bR=false end elseif C==a.aS then X[a.ei]=true;X[a.ef]=Z;X.Type=p;if bR==nil then bR={}end elseif C==a.ba or C==a.aZ then X.Type=t;X[a.dR]=b7;local b9=b9;if b9~=nil and type(b9)==a.bi then X[a.dR]=math[a.dA](b9)if X[a.dR]<=0 then X[a.dR]=b7 end;X[a.dR]=math.min(X[a.dR],b7)end;if C==a.ba then X[a.ef]=b8;if bR==nil then bR=''end else X[a.ei]=true;X[a.ef]=bf;if bR==nil then bR={}end end else return false end;X[a.eC]=bR;return true end;function bO:Field(bS,bM,C,bQ)if bQ==nil then bQ={}end;if bS==nil or type(bS)~=a.bi or math[a.dA](bS)~=bS or bS<0 or bS>15 then error(a.ci)end;if bM==nil or type(bM)~=a.ba or bM==''then error(a.ck)end;if C==nil then error(a.cl)end;for as,X in ipairs(self[a.ed])do if X.Name==bM then error(a.cm..bM)end;if X.Id==bS then error(a.cn..bS)end end;local X={}X.Id=bS;X.Name=bM;X[a.ei]=false;if bP(C,X,bQ)then elseif C[a.eF]then X.Type=u;X[a.eb]=C;if bQ[a.ei]then X[a.ei]=true;X[a.ef]=bq else X[a.ef]=bp end else local bT=bm[C]if bT==nil then error(a.co)end;if bQ[a.ei]then bP(bT[2][1],X,bQ)X[a.eC]=bT[2][2]X[a.ee]=bT[2][3]X[a.ej]=bT[2][4]else bP(bT[1][1],X,bQ)X[a.eC]=bT[1][2]X[a.ee]=bT[1][3]X[a.ej]=bT[1][4]end end;if X[a.ee]==nil and type(bQ[a.eG])==a.cp then X[a.ee]=bQ[a.eG]end;if X[a.ej]==nil and type(bQ[a.eH])==a.cp then X[a.ej]=bQ[a.eH]end;table[a.cX](self[a.ed],X)self[a.eg][X.Id]=X;return self end;function bO:Serialize(br)return bo(br,self,false)end;local function bU(bS)if type(bS)==a.bi then if bS<0 or bS>254 then error(a.cq)end;if bn[bS]~=nil then error(a.cr)end;local bj={}bj[a.eF]=true;bj.Id=bS;bj[a.ed]={}bj[a.eg]={}setmetatable(bj,bO)bn[bS]=bj;return bj else local bV=bS;local bj=bU(bV.Id)if bV[a.ed]~=nil then for bM,bW in pairs(bV[a.ed])do bj:Field(bW.Id,bM,bW.Type,{Default=bW[a.eC],MaxLength=bW[a.dR],ToSerialize=bW[a.eG],ToInstance=bW[a.eH]})end end;return bj end end;local bX={}bX[a.eb]=bU;bX[a.eI]=bw;return bX end end
